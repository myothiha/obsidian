
# Introduction

Though LLMs excel at natural language processing and generation, its knowledge are limited to their training corpus. They are unable to answer or hallucinate when they have to perform tasks which require knowledge beyond their their internal knowledge. Retrieval Augmented Generation is technique that can help LLMs to cover come that limitation by retrieving knowledge from the external knowledge source and provide them to LLMs as the contextual information. LLM can now access the external knowledge required to perform the tasks.

The product search feature of the E-commerce systems is the essential features since it is the interface where user can access their desired products. Showing all the products relevant to the user search query is essential to ensure customer satisfaction and promote sales of all products. However, most users' queries are not simple keywords like laptop, earphones that can map to exact product name to categories. They might not even know what they're searching for. For example, a query can be "a powerful computer for an AI professional" which required understanding of unstructured product knowledge to find relevant products to the queries. The power of LLM is understand and process un-structure natural language and RAG provide the ability to integrate external product knowledge into LLMs to implement a powerful semantic product search in E-commerce systems.

# Problem Statement

The research is for developing a system that integrate Retrieval Augmented Generation with LLM into an E-commerce system with 4 million products, 14 million offers and 2 million daily search queries across 600 stores. 

# Objectives

In order to make sure the product is practical and suable in the real world context, there are several objectives, we need to achieve. 
1. Make sure answers generated by Large Language Models (LLMs) are relevant and grounded to the internal product and offer data. 
2. Ensure 300 milli seconds or less response time for each user query.
3. Minimize energy consumption  when deploying in-house LLM.
4. Assess whether external LLM services can be used cost-effectively at scale.
5. Implement a hybrid architecture combining traditional search for short queries and LLMs for longer ones for efficient computation. 
6. **Conduct a critical assessment of commercial solutions (e.g. Google Vertex AI Agent Builder) to benchmark against the proposed solution.** 
# State of the Art Analysis

RAG systems involve two main components: a retriever and a generator. When a user provide a complete / partial query, a retriever extract knowledge from the sources that is relevant to the input and provide it to the LLM to generate answer to the query [1]. Depending on those components, RAG researches have four directions in general: retriever oriented, generator oriented, hybrid and robustness oriented approaches.  Retriever oriented RAG system focus on optimizing the retriever part of the system by refining input query , enhancing retriever architecture, filtering irrelevant information from the passive, and compressing long information into compact efficient representation. 

Similarly, generator based RAG system focus on generator part. The common pattern involve Faithfulness awareness decoding, context compression, utility filtering and generation control [1].  They improve RAG generator by refining model's output [4], making sure the output is grounded in the retrieved passage, compressing encoder output across retrieved passages so that it fit the context window of LLM, adjust reranking based on the type task, retrieval metadata and agentic decision making so that only knowledge relevant to the task is remained. 

On the other hand, hybrid RAG systems involve both retriever and generator. Instead of treating them as individual components, they focus on the coordinating between the two components. The trends of developing hybrid RAG systems involves iterating between the retriever and generator to perform continuous evidence and answer refinement, applying reinforce-based gradients to adapt both components, implementing dynamic retrieval mechanism during the generation uncertainty [1]. 

Finally, robustness and security-oriented RAG systems focus on improving robustness against irrelevant or misleading context, detecting incorrect or hallucinating information in the generation, and preventing semantic backdoors attacks trigged by intentionally passages to prevent possible security compromise [1]. 

In the e-commerce setting, research on Retrieval-Augmented Generation (RAG) remains limited, primarily due to the scarcity of large-scale datasets. Product search datasets, in particular, would need to include extensive product information, user reviews, search logs, and user journey data, all of which raise privacy concerns and face business regulations that hinder open research [6]. Within this constrained landscape, three representative works are found to be highly related to our research. 

The first is ProductRAG by Amazon Research [2], a framework designed to improve query auto-completion (QAC) by generating precise suggestions grounded in product knowledge and aligned with the user’s search prefixes. The second is BSharedRAG [3], which employs a single large language model backbone fine-tuned on an e-commerce corpus, with LoRA adapters applied for both retrieval and generation tasks. By sharing information between the retriever and generator through the adapters, it highlights a promising direction for improving alignment and efficiency in e-commerce RAG systems. 

The third is a graph-based RAG framework [7], which constructs an item–feature knowledge graph from user reviews and integrates it into the retrieval process. By leveraging graph traversal to explore both explicit and implicit item–feature connections, this framework enhances the diversity, fidelity, and contextual grounding of generated product descriptions. Together, these studies represent the most relevant and reputable RAG approaches for e-commerce to date, but they also reveal gaps in efficiency, scalability, and evaluation that our work seeks to address.

# Propose Approach

In this section,  several methods will be proposed to achieve the to objectives of the research. 

 First, the retriever need to match user's input queries to relevant products. For this tasking, understanding user intent and comprehensive products and offers knowledge are essential. To improve the understanding of user intent, current researches have proposed many methods such as RQ-RAG [5], GMR and RAG-Fusion. RQ-RAG improve user intent by rewriting, decomposition and disambiguation to have a clearer query before the retrieval process. On the other hand, RAG-fusion breakdown the original query into multiple sub and alternative queries to cover different interpretations and subtopics in several contents. Similarly, GMR also focus on user queries with multiple hops, but it use reasoning chains to generate step by step modeling to retrieve the relevant information.

### Make sure answers generated by Large Language Models (LLMs) are relevant and grounded to the internal product and offer data. 

For a product search feature, generation part of the a RAG system is not necessary since the retriever can fetch relevant products according to the user query and return as it is. Only when E-commerce have a LLM power sales support system like chatbot, the generator become essential. Nevertheless, an evaluation to measure performance of the retriever and generator is essential to choose the best approaches and models for them. The evaluation system will measure whether the products and offers retrieved by the retriever and responses generated by LLMs are grounded to the internal product and offer information.

ARES proposes building a synthetic queries and response leveraging the existing external products and offers data [8]. Then, LLM judges can be trained to evaluate the RAG responses in terms relevancy, answer faithfulness and answer relevance score. In addition, ARES propose a PPI rectifier function build from the small human preference set. Then, that function can be use to estimate the errors of the LLM judges and generate the confidence intervals for the success and failure rate of our RAG system [8].

(Review)
For a product search feature, the generation component of a RAG system is not always necessary, since the retriever can directly fetch relevant products according to the user query and return them as they are. The generator becomes essential mainly when e-commerce platforms deploy LLM-powered sales support systems, such as conversational chatbots. Nevertheless, rigorous evaluation of both the retriever and the generator is critical for selecting the most effective approaches and models. The evaluation system must measure whether the retrieved products and offers, as well as the responses generated by LLMs, remain relevant and faithfully grounded in the internal product and offer information.

ARES proposes an evaluation framework that builds synthetic queries and responses by leveraging existing external product and offer data [8]. LLM judges are then trained to classify RAG outputs along three dimensions: relevance, faithfulness, and answer relevance score. In addition, ARES introduces a PPI rectifier function derived from a small set of human preferences  [8]. This rectifier is used to estimate the error rates of the LLM judges and to generate confidence intervals for both the success and failure rates of the RAG system.

### Ensure 300 milli seconds or less response time for each user query.

There are many aspect to work on to improve response of the user queries. 

Most e-commerce systems use one or more database management system such as MySQL, Oracle, MongoDB or Neo4J to store their products and offers data.

### Minimize energy consumption  when deploying in-house LLM.

### Assess whether external LLM services can be used cost-effectively at scale.

### Implement a hybrid architecture combining traditional search for short queries and LLMs for longer ones for efficient computation. 

### Conduct a critical assessment of commercial solutions (e.g. Google Vertex AI Agent Builder) to benchmark against the proposed solution. 
# Dataset

# Evaluation

We need to evaluate perform several evaluation on different components and different aspect of the proposed to make sure it usable in the real world E-commerce setting. There are several evaluation dimension for this system.
1. Context Relevance: evaluate how the proposed system fetch products and offers relevant to the user queries. We can use nDCG@10, MRR, Success@1, Recall@k for the measurement of relevancy.
2. Efficiency: evaluate average response times and energy consumption for the queries. 
3. Robustness: check the noise tolerance of the proposed system.
4. Cost & Throughput: Euro per 1k queries, tokens/query for paid LLMs. 


[1] C. Sharma, “Retrieval-Augmented Generation: A Comprehensive Survey of Architectures, Enhancements, and Robustness Frontiers,” May 28, 2025, arXiv: arXiv:2506.00054. doi: 10.48550/arXiv.2506.00054.
[2] F. Sun et al., “A Product-Aware Query Auto-Completion Framework for E-Commerce Search via Retrieval-Augmented Generation Method,” 2024.
[3] K. Guan, Q. Cao, Y. Sun, X. Wang, and R. Song, “BSharedRAG: Backbone Shared Retrieval-Augmented Generation for the E-commerce Domain,” Sept. 30, 2024, arXiv: arXiv:2409.20075. doi: 10.48550/arXiv.2409.20075.
[4] Akari Asai, Zeqiu Wu, Yizhong Wang, Avirup Sil, and Hannaneh Hajishirzi. 2024. Self-RAG: Learning to Retrieve, Generate, and Critique through Self-Reflection. In The Twelfth International Conference on Learning Representations. https://openreview.net/forum?id=hSyW5go0v8
[5] Chi-Min Chan, Chunpu Xu, Ruibin Yuan, Hongyin Luo, Wei Xue, Yike Guo, and Jie Fu. 2024. RQ-RAG: Learning to Refine Queries for Retrieval Augmented Generation. In First Conference on Language Modeling. https://openreview.net/forum?id=tzE7VqsaJ4
[6] M. Tsagkias, T. H. King, S. Kallumadi, V. Murdock, and M. De Rijke, “Challenges and research opportunities in eCommerce search and recommendations,” SIGIR Forum, vol. 54, no. 1, pp. 1–23, June 2020, doi: 10.1145/3451964.3451966.
[7] J. Yang, Y. Jia, C. Yang, Y. Liang, and L. Lin, “Boosting E-commerce Content Diversity: A Graph-based RAG Approach with User Reviews,” in Proceedings of the 31st ACM SIGKDD Conference on Knowledge Discovery and Data Mining V.2, Toronto ON Canada: ACM, Aug. 2025, pp. 3495–3506. doi: 10.1145/3711896.3736864.
[8] J. Saad-Falcon, O. Khattab, C. Potts, and M. Zaharia, “ARES: An Automated Evaluation Framework for Retrieval-Augmented Generation Systems,” Mar. 31, 2024, arXiv: arXiv:2311.09476. doi: 10.48550/arXiv.2311.09476.







